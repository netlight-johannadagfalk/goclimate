<% title(t('views.lifestyle_footprints.title')) %>

<%= render "shared/header" %>

<div class="relative min-h-screen bg-blue-tint-1 -mt-20 pt-20 z-10">
  <section class="text-primary text-base">
    <div class="text-center pt-16 pb-48 px-4 md:px-10 lg:px-0 max-w-2xl mx-auto space-y-6">
      <% if experiment_active?(:v1) || experiment_active?(:v2) %>  
        <%= react_component 'Container', 
          lang: I18n.locale[0..-1], 
          currentRegion: current_region.to_json, 
          currency: YAML.load_file('config/locales/models.' + I18n.locale[0..-1] + '.yml')[I18n.locale[0..-1]]['models'].to_json,
          lifestyleFootprintsText: YAML.load_file('config/locales/views/lifestyle_footprints.' + I18n.locale[0..-1] + '.yml')[I18n.locale[0..-1]]['views']['lifestyle_footprints'].to_json,
          footprint: @footprint.to_json, 
          calculator: @calculator.to_json,
          registrationsText: YAML.load_file('config/locales/views/registrations.' + I18n.locale[0..-1] + '.yml')[I18n.locale[0..-1]]['views']['registrations'].to_json, 
          commonText: YAML.load_file('config/locales/' + I18n.locale[0..-1] + '.yml')[I18n.locale[0..-1]].to_json,
          modelText: YAML.load_file('config/locales/models.' + I18n.locale[0..-1] + '.yml')[I18n.locale[0..-1]]['models']['greenhouse_gases']['tonnes'].to_json,
          projects: @projects.to_json,
          version: experiment_active?(:v2) ? 'v2' : 'v1',
          reactContentText: YAML.load_file('config/locales/views/react_lifestyle_footprints.' + I18n.locale[0..-1] + '.yml')[I18n.locale[0..-1]]['views']['react_lifestyle_footprints'].to_json,
          sharedText: YAML.load_file('config/locales/views/shared.' + I18n.locale[0..-1] + '.yml')[I18n.locale[0..-1]]['views']['shared'].to_json,
          isUserSignedIn: current_user ? true : false
        %>
      <% else %>
        <div class="callout" data-controller="lifestyle-footprints--calculator">
          <div class="flex justify-center space-x-3 m-lg:space-x-6 text-gray-shade-2">
            <% if @calculator.region_options.present? || @calculator.home_options.present? || @calculator.home_area_options.present? || @calculator.heating_options.present? || @calculator.green_electricity_options.present? %>
            <div>
              <div class="mb-2 border border-gray-tint-2 rounded-full w-12 h-12 flex justify-center items-center box-content p-1"
                data-active-class="mb-2 border border-green-tint-1 bg-green-tint-1 text-primary rounded-full w-12 h-12 flex justify-center items-center box-content p-1"
                data-target="lifestyle-footprints--calculator.categoryIndicator"
                data-category="home"
              >
                <i class="fas fa-lg fa-home" aria-hidden="true"></i>
              </div>
              <div class="text-sm text-gray-accent block"
                data-target="lifestyle-footprints--calculator.categoryQuestionList"
                data-active-class="text-sm text-gray-accent block"
                data-inactive-class="text-sm text-gray-accent hidden"
              >
                <% if @calculator.region_options.present? %>
                  <i class="far fa-circle" data-active-class="fas fa-circle text-green-accent" data-target="lifestyle-footprints--calculator.questionIndicator" data-category="home"></i>
                <% end %>
                <% if @calculator.home_options.present? %>
                  <i class="far fa-circle" data-active-class="fas fa-circle text-green-accent" data-target="lifestyle-footprints--calculator.questionIndicator" data-category="home"></i>
                <% end %>
                <% if @calculator.home_area_options.present? %>
                  <i class="far fa-circle" data-active-class="fas fa-circle text-green-accent" data-target="lifestyle-footprints--calculator.questionIndicator" data-category="home"></i>
                <% end %>
                <% if @calculator.heating_options.present? %>
                  <i class="far fa-circle" data-active-class="fas fa-circle text-green-accent" data-target="lifestyle-footprints--calculator.questionIndicator" data-category="home"></i>
                <% end %>
                <% if @calculator.green_electricity_options.present? %>
                  <i class="far fa-circle" data-active-class="fas fa-circle text-green-accent" data-target="lifestyle-footprints--calculator.questionIndicator" data-category="home"></i>
                <% end %>
              </div>
              <div class="text-green-accent hidden"
                data-target="lifestyle-footprints--calculator.categoryCheckmark"
                data-active-class="text-green-accent block"
                data-inactive-class="text-green-accent hidden"
              >
                <i class="fa fa-check-circle"></i>
              </div>
            </div>
            <% end %>
            <% if @calculator.food_options.present? %>
              <div>
                <div class="mb-2 border border-gray-tint-2 rounded-full w-12 h-12 flex justify-center items-center box-content p-1"
                  data-active-class="mb-2 border border-green-tint-1 bg-green-tint-1 text-primary rounded-full w-12 h-12 flex justify-center items-center box-content p-1"
                  data-target="lifestyle-footprints--calculator.categoryIndicator"
                  data-category="food"
                >
                  <i class="fas fa-lg fa-utensils" aria-hidden="true"></i>
                </div>
              <div class="text-sm text-gray-accent block"
                data-target="lifestyle-footprints--calculator.categoryQuestionList"
                data-active-class="text-sm text-gray-accent block"
                data-inactive-class="text-sm text-gray-accent hidden"
              >
                <% if @calculator.food_options.present? %>
                  <i class="far fa-circle" data-active-class="fas fa-circle text-green-accent" data-target="lifestyle-footprints--calculator.questionIndicator" data-category="food"></i>
                <% end %>
              </div>
              <div class="text-green-accent hidden"
                data-target="lifestyle-footprints--calculator.categoryCheckmark"
                data-active-class="text-green-accent block"
                data-inactive-class="text-green-accent hidden"
              >
                <i class="fa fa-check-circle"></i>
              </div>
              </div>
            <% end %>
            <% if @calculator.shopping_options.present? %>
              <div>
                <div class="mb-2 border border-gray-tint-2 rounded-full w-12 h-12 flex justify-center items-center box-content p-1"
                  data-active-class="mb-2 border border-green-tint-1 bg-green-tint-1 text-primary rounded-full w-12 h-12 flex justify-center items-center box-content p-1"
                  data-target="lifestyle-footprints--calculator.categoryIndicator"
                  data-category="consumption"
                >
                  <i class="fas fa-lg fa-shopping-bag" aria-hidden="true"></i>
                </div>
                <div class="text-sm text-gray-accent block"
                    data-target="lifestyle-footprints--calculator.categoryQuestionList"
                    data-active-class="text-sm text-gray-accent block"
                    data-inactive-class="text-sm text-gray-accent hidden"
                    >
                  <i class="far fa-circle" data-active-class="fas fa-circle text-green-accent" data-target="lifestyle-footprints--calculator.questionIndicator" data-category="consumption"></i>
                </div>
                <div class="text-green-accent hidden"
                  data-target="lifestyle-footprints--calculator.categoryCheckmark"
                  data-active-class="text-green-accent block"
                  data-inactive-class="text-green-accent hidden"
                >
                  <i class="fa fa-check-circle"></i>
                </div>
              </div>
            <% end %>
            <% if @calculator.car_type_options.present? %>
              <div>
                <div class="mb-2 border border-gray-tint-2 rounded-full w-12 h-12 flex justify-center items-center box-content p-1"
                  data-active-class="mb-2 border border-green-tint-1 bg-green-tint-1 text-primary rounded-full w-12 h-12 flex justify-center items-center box-content p-1"
                  data-target="lifestyle-footprints--calculator.categoryIndicator"
                  data-category="car"
                >
                  <i class="fas fa-lg fa-car" aria-hidden="true"></i>
                </div>
                <div class="text-sm text-gray-accent block"
                  data-target="lifestyle-footprints--calculator.categoryQuestionList"
                  data-active-class="text-sm text-gray-accent block"
                  data-inactive-class="text-sm text-gray-accent hidden"
                >
                  <% if @calculator.car_type_options.present? %>
                    <i class="far fa-circle" data-active-class="fas fa-circle text-green-accent" data-target="lifestyle-footprints--calculator.questionIndicator" data-category="car"></i>
                    <i class="far fa-circle" data-active-class="fas fa-circle text-green-accent" data-target="lifestyle-footprints--calculator.questionIndicator" data-category="car"></i>
                  <% end %>
                </div>
                <div class="text-green-accent hidden"
                  data-target="lifestyle-footprints--calculator.categoryCheckmark"
                  data-active-class="text-green-accent block"
                  data-inactive-class="text-green-accent hidden"
                >
                  <i class="fa fa-check-circle"></i>
                </div>
              </div>
            <% end %>
            <div>
              <div class="mb-2 border border-gray-tint-2 rounded-full w-12 h-12 flex justify-center items-center box-content p-1"
                data-active-class="mb-2 border border-green-tint-1 bg-green-tint-1 text-primary rounded-full w-12 h-12 flex justify-center items-center box-content p-1"
                data-target="lifestyle-footprints--calculator.categoryIndicator"
                data-category="flights"
              >
                <i class="fas fa-lg fa-plane" aria-hidden="true"></i>
              </div>
              <div class="text-sm text-gray-accent block"
                data-target="lifestyle-footprints--calculator.categoryQuestionList"
                data-active-class="text-sm text-gray-accent block"
                data-inactive-class="text-sm text-gray-accent hidden"
              >
                  <i class="far fa-circle" data-active-class="fas fa-circle text-green-accent" data-target="lifestyle-footprints--calculator.questionIndicator" data-category="flights"></i>
              </div>
              <div class="text-green-accent hidden"
                data-target="lifestyle-footprints--calculator.categoryCheckmark"
                data-active-class="text-green-accent block"
                data-inactive-class="text-green-accent hidden"
              >
                <i class="fa fa-check-circle"></i>
              </div>
            </div>
          </div>

          <%= form_with model: @footprint, url: new_lifestyle_footprint_path do |f| %>
            <%= f.hidden_field :lifestyle_calculator_id %>
            <%= f.hidden_field :country %>
            <%= hidden_field_tag :campaign, params[:campaign] %>

            <% if @calculator.region_options.present? %>
              <div class="question py-8 hidden" data-target="lifestyle-footprints--calculator.question" data-category="home">
                <h2 class="heading my-4"><%=t 'views.lifestyle_footprints.questions.region' %></h2>
                <% @calculator.region_options.each do |option| %>
                  <div class="my-3">
                    <%= f.radio_button :region_answer, option['key'], required: '', class: 'hidden', 'data-action': "click->lifestyle-footprints--calculator#nextQuestion" %>
                    <%= f.label :region_answer, t("views.lifestyle_footprints.options.region.#{option['key']}"), value: option['key'], class: 'hidden button button-cta toggler-checked:block' %>
                    <%= f.label :region_answer, t("views.lifestyle_footprints.options.region.#{option['key']}"), value: option['key'], class: 'block button toggler-checked:hidden' %>
                  </div>
                <% end %>
              </div>
            <% end %>

            <% if @calculator.home_options.present? %>
              <div class="question py-8 hidden" data-target="lifestyle-footprints--calculator.question" data-category="home">
                <h2 class="heading my-4"><%=t 'views.lifestyle_footprints.questions.home' %></h2>
                <% @calculator.home_options.each do |option| %>
                  <div class="my-3">
                    <%= f.radio_button :home_answer, option['key'], required: '', class: 'toggler', 'data-action': "click->lifestyle-footprints--calculator#nextQuestion" %>
                    <%= f.label :home_answer, t("views.lifestyle_footprints.options.home.#{option['key']}"), value: option['key'], class: 'hidden button button-cta toggler-checked:block' %>
                    <%= f.label :home_answer, t("views.lifestyle_footprints.options.home.#{option['key']}"), value: option['key'], class: 'block button toggler-checked:hidden' %>
                  </div>
                <% end %>
              </div>
            <% end %>

            <% if @calculator.home_area_options.present? %>
              <div class="question py-8 hidden" data-target="lifestyle-footprints--calculator.question" data-category="home">
                <h2 class="heading my-4"><%=t 'views.lifestyle_footprints.questions.home_area' %></h2>
                <% @calculator.home_area_options.each do |option| %>
                  <div class="my-3">
                    <%= f.radio_button :home_area_answer, option['key'], required: '', class: 'toggler', 'data-action': "click->lifestyle-footprints--calculator#nextQuestion" %>
                    <%= f.label :home_area_answer, t("views.lifestyle_footprints.options.home_area.#{option['key']}"), value: option['key'], class: 'hidden button button-cta toggler-checked:block' %>
                    <%= f.label :home_area_answer, t("views.lifestyle_footprints.options.home_area.#{option['key']}"), value: option['key'], class: 'block button toggler-checked:hidden' %>
                  </div>
                <% end %>
              </div>
            <% end %>

            <% if @calculator.heating_options.present? %>
              <div class="question py-8 hidden" data-target="lifestyle-footprints--calculator.question" data-category="home">
                <h2 class="heading my-4"><%=t 'views.lifestyle_footprints.questions.heating' %></h2>
                <% @calculator.heating_options.each do |option| %>
                  <div class="my-3">
                    <%= f.radio_button :heating_answer, option['key'], required: '', class: 'toggler', 'data-action': "click->lifestyle-footprints--calculator#nextQuestion" %>
                    <%= f.label :heating_answer, t("views.lifestyle_footprints.options.heating.#{option['key']}"), value: option['key'], class: 'hidden button button-cta toggler-checked:block' %>
                    <%= f.label :heating_answer, t("views.lifestyle_footprints.options.heating.#{option['key']}"), value: option['key'], class: 'block button toggler-checked:hidden' %>
                  </div>
                <% end %>
              </div>
            <% end %>

            <% if @calculator.green_electricity_options.present? %>
              <div class="question py-8 hidden" data-target="lifestyle-footprints--calculator.question" data-category="home">
                <h2 class="heading my-4"><%=t 'views.lifestyle_footprints.questions.green_electricity' %></h2>
                <% @calculator.green_electricity_options.each do |option| %>
                  <div class="my-3">
                    <%= f.radio_button :green_electricity_answer, option['key'], required: '', class: 'toggler', 'data-action': "click->lifestyle-footprints--calculator#nextQuestion" %>
                    <%= f.label :green_electricity_answer, t("views.lifestyle_footprints.options.green_electricity.#{option['key']}"), value: option['key'], class: 'hidden button button-cta toggler-checked:block' %>
                    <%= f.label :green_electricity_answer, t("views.lifestyle_footprints.options.green_electricity.#{option['key']}"), value: option['key'], class: 'block button toggler-checked:hidden' %>
                  </div>
                <% end %>
              </div>
            <% end %>

            <% if @calculator.food_options.present? %>
              <div class="question py-8 hidden" data-target="lifestyle-footprints--calculator.question" data-category="food">
                <h2 class="heading my-4"><%=t 'views.lifestyle_footprints.questions.food' %></h2>
                <% @calculator.food_options.each do |option| %>
                  <div class="my-3">
                    <%= f.radio_button :food_answer, option['key'], required: '', class: 'toggler', 'data-action': "click->lifestyle-footprints--calculator#nextQuestion" %>
                    <%= f.label :food_answer, t("views.lifestyle_footprints.options.food.#{option['key']}"), value: option['key'], class: 'hidden button button-cta toggler-checked:block' %>
                    <%= f.label :food_answer, t("views.lifestyle_footprints.options.food.#{option['key']}"), value: option['key'], class: 'block button toggler-checked:hidden' %>
                  </div>
                <% end %>
              </div>
            <% end %>

            <% if @calculator.shopping_options.present? %>
              <div class="question py-8 hidden" data-target="lifestyle-footprints--calculator.question" data-category="consumption">
                <h2 class="heading my-4"><%=t 'views.lifestyle_footprints.questions.shopping' %></h2>
                <% @calculator.shopping_options.each do |option| %>
                  <label class="block button my-3">
                    <%= f.radio_button :shopping_answer, option['key'], required: '', class: 'hidden', 'data-action': 'click->lifestyle-footprints--calculator#nextQuestion' %>
                    <%=t "views.lifestyle_footprints.options.shopping.#{option['key']}" %>
                  </label>
                <% end %>
              </div>
            <% end %>

            <% if @calculator.car_type_options.present? %>
              <div class="question py-8 hidden" data-target="lifestyle-footprints--calculator.question" data-category="car">
                <h2 class="heading my-4"><%=t 'views.lifestyle_footprints.questions.car_type' %></h2>
                <% @calculator.car_type_options.each do |option| %>
                  <div class="my-3">
                    <%= f.radio_button :car_type_answer, option['key'], required: '', class: 'toggler', 'data-action': option['key'] == 'no_car' ? 'click->lifestyle-footprints--calculator#nextCategory' : 'click->lifestyle-footprints--calculator#nextQuestion' %>
                    <%= f.label :car_type_answer, t("views.lifestyle_footprints.options.car_type.#{option['key']}"), value: option['key'], class: 'hidden button button-cta toggler-checked:block' %>
                    <%= f.label :car_type_answer, t("views.lifestyle_footprints.options.car_type.#{option['key']}"), value: option['key'], class: 'block button toggler-checked:hidden' %>
                  </div>
                <% end %>
              </div>
            <% end %>

            <% if @calculator.car_type_options.present? %>
              <div class="question py-8 hidden" data-target="lifestyle-footprints--calculator.question" data-category="car">
                <h2 class="heading my-4"><%=t 'views.lifestyle_footprints.questions.car_distance' %></h2>
                <div class="flex flex-col m-lg:flex-row">
                  <label class="input mb-3 m-lg:mb-0 m-lg:mr-3 flex">
                    <%= number_field_tag :car_distance_week_answer, '', min: 0, max: 2147483647, size: 7, class: 'flex-1' %>
                    <span class="ml-3"><%= @calculator.car_distance_unit %></span>
                  </label>
                  <%= f.button t('views.lifestyle_footprints.next'), type: 'button', class: 'button flex-1', 'data-action': 'click->lifestyle-footprints--calculator#nextQuestion' %>
                </div>
              </div>
            <% end %>

            <div class="question py-8 hidden" data-target="lifestyle-footprints--calculator.question" data-category="flights">
              <h2 class="heading my-4"><%=t 'views.lifestyle_footprints.questions.flight_hours' %></h2>
              <div class="flex flex-col m-lg:flex-row">
                <%= f.number_field :flight_hours_answer, min: 0, max: 2147483647, size: 7, class: 'input mb-3 m-lg:mb-0 m-lg:mr-3' %>
                <%= f.submit t('views.lifestyle_footprints.next'), class: 'button flex-1' %>
              </div>
            </div>

          <% end %>

          <div class="flex justify-space-between">
            <div class="hidden cursor-pointer"
              data-target="lifestyle-footprints--calculator.back"
              data-action="click->lifestyle-footprints--calculator#previousQuestion"
              data-active-class="block cursor-pointer"
              data-inactive-class="hidden cursor-pointer"
            >
              <i class="fas fa-chevron-left" aria-hidden="true"></i>
              <span><%=t 'views.lifestyle_footprints.back' %></span>
            </div>
          </div>
        </div>
        <div class="text-sm">
          <a class="link" href="https://www.goclimate.com/blog/methodology-behind-the-carbon-footprint-calculator/" target="_blank"><%= t 'views.lifestyle_footprints.methodology' %></a>
        </div>
      <% end %>
    </div>
  </section>

  <div class="absolute bottom-0 w-full -z-10">
    <%= render "shared/bottom_landscape" %>
  </div>
</div>
